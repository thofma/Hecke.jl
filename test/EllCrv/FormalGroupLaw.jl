@testset "Formal group law for elliptic curves" begin
  
  E = EllipticCurve([1, 2, 3, 4, 5])
  
  w = formal_w(E, 20)
  Rz = parent(w)
  z = gen(Rz)
  
  w_test = z^3 + z^4 + 3*z^5 + 8*z^6 + 24*z^7 + 69*z^8 + 216*z^9 + 676*z^10 + 2162*z^11 + 6999*z^12 + 22961*z^13 + 75973*z^14 + 253586*z^15 + 852452*z^16 + 2883782*z^17 + 9809430*z^18 + 33532966*z^19 
  @test w == w_test
  
  y = formal_y(E, 20)
  Rz = parent(y)
  z = gen(Rz)
  
  y_test = -z^-3 + z^-2 + 2*z^-1 + 3 + 7*z + 13*z^2 + 41*z^3 + 114*z^4 + 338*z^5 + 1034*z^6 + 3257*z^7 + 10360*z^8 + 33535*z^9 + 109789*z^10 + 363023*z^11 + 1210380*z^12 + 4065885*z^13 + 13744704*z^14 + 46726358*z^15 + 159644768*z^16 + 547878855*z^17 + 1887785743*z^18 + 6528201207*z^19 
  @test y == y_test
  
  x = formal_x(E, 20)
  Rz = parent(x)
  z = gen(Rz)
  
  x_test = z^-2 - z^-1 - 2 - 3*z - 7*z^2 - 13*z^3 - 41*z^4 - 114*z^5 - 338*z^6 - 1034*z^7 - 3257*z^8 - 10360*z^9 - 33535*z^10 - 109789*z^11 - 363023*z^12 - 1210380*z^13 - 4065885*z^14 - 13744704*z^15 - 46726358*z^16 - 159644768*z^17 - 547878855*z^18 - 1887785743*z^19
  
  @test x == x_test
  
  omega = formal_differential_form(E, 20)
  Rz = parent(omega)
  z = gen(Rz)
  
  omega_test = 1 + z + 3*z^2 + 11*z^3 + 37*z^4 + 117*z^5 + 412*z^6 + 1425*z^7 + 4965*z^8 + 17447*z^9 + 61764*z^10 + 219219*z^11 + 781431*z^12 + 2794392*z^13 + 10019736*z^14 + 36010699*z^15 + 129694399*z^16 + 467949759*z^17 + 1691151928*z^18 + 6120651617*z^19
  @test omega == omega_test
  
  logE = @inferred formal_log(E, 20)
  Rz = parent(logE)
  z = gen(Rz)
  
  logE_test = z + 1//2*z^2 + z^3 + 11//4*z^4 + 37//5*z^5 + 39//2*z^6 + 412//7*z^7 + 1425//8*z^8 + 1655//3*z^9 + 17447//10*z^10 + 61764//11*z^11 + 73073//4*z^12 + 781431//13*z^13 + 1397196//7*z^14 + 3339912//5*z^15 + 36010699//16*z^16 + 129694399//17*z^17 + 155983253//6*z^18 + 1691151928//19*z^19
  @test logE == logE_test
  
  inv = @inferred formal_inverse(E, 20)
  Rz = parent(inv)
  z = gen(Rz)
  
  inv_test = -z - z^2 - z^3 - 4*z^4 - 10*z^5 - 25*z^6 - 73*z^7 - 220*z^8 - 664*z^9 - 2071*z^10 - 6586*z^11 - 21205*z^12 - 69115*z^13 - 227731*z^14 - 756853*z^15 - 2534551*z^16 - 8544847*z^17 - 28977244*z^18 - 98779447*z^19
  @test inv == inv_test
    

end
