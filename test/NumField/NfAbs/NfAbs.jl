@testset "NumField/NfAbs/NfAbs" begin
  cyclo_expl = function(n, m)
    Fn, zn = cyclotomic_field(n)
    Fnm, znm = cyclotomic_field(n*m)
    x = zn
    x_up = Hecke.force_coerce_cyclo(Fnm, x)
    x_down = Hecke.force_coerce_cyclo(Fn, x_up)
    return (x, x_up, x_down)
  end

  res = cyclo_expl(3, 4)
  @test (res[1]^3, res[2]^3) == (1, 1)

  res = cyclo_expl(3, 2)
  z6 = gen(parent(res[2]))
  # Test that z3 is mapped to z6^2
  @test z6^2 == res[2]
end

@testset "Splitting Field" begin

  Qx, x = polynomial_ring(QQ, "x")
  f = x^3-2
  K = splitting_field(f)
  @test typeof(K) == AbsSimpleNumField
  K1 = number_field([x^3-2, x^2+x+1])[1]
  K1abs = simple_extension(K1)[1]
  @test is_isomorphic(K, K1abs)
  K, R = splitting_field(f, do_roots = true)
  for r in R
    @test iszero(f(r))
    @test all(x->parent(x) === K, R)
  end

  K, a = number_field(x^2+1)
  Kt, t = polynomial_ring(K, "t")
  g = t^4-2
  L = splitting_field(g)
  @test typeof(L) == Hecke.RelSimpleNumField{AbsSimpleNumFieldElem}
  @test absolute_degree(L) == 8
end

@testset "simplify" begin

  Qx, x = polynomial_ring(QQ, "x")
  K = number_field(x^5 - x^4 - x^3 - 220*x^2 - 360*x - 200)[1]
  @test typeof(K) == AbsSimpleNumField
  L = simplify(K, canonical = true)[1]
  @test L.pol == x^5 - x^4 + x^3 - 19*x^2 + 35*x + 77
end

@testset "simplify-Gunter" begin

  Qx, x = polynomial_ring(QQ, "x")
  f = x^18 - x^16 - 6*x^14 - 4*x^12 - 4*x^10 + 2*x^8 + 6*x^6 - 4*x^4 + 3*x^2 - 1
  g = x^18 - 3*x^16 + 4*x^14 - 6*x^12 - 2*x^10 + 4*x^8 + 4*x^6 + 6*x^4 + x^2 - 1
  h = x^18 + x^16 - x^14 - 8*x^12 - 3*x^8 + 27*x^6 - 25*x^4 + 8*x^2 - 1
  @test simplify(number_field(f)[1], canonical = true)[1].pol == g
  @test simplify(number_field(g)[1], canonical = true)[1].pol == g
  @test simplify(number_field(h)[1], canonical = true)[1].pol == g
end

@testset "simplify-Fabian" begin
  Qx, x = polynomial_ring(QQ, "x")
  f = x^8 + 4*x^7 - 56*x^6 - 168*x^5 + 758*x^4 + 2412*x^3 - 1656*x^2 - 9508*x - 6828
  g = x^8 - 4*x^7 - 30*x^6 + 44*x^5 + 298*x^4 + 108*x^3 - 614*x^2 - 680*x - 199
  @test simplify(number_field(f)[1], canonical = true)[1].pol == g
  @test simplify(number_field(g)[1], canonical = true)[1].pol == g
end


@testset "factor-van-Hoeij" begin
 Qx, x = polynomial_ring(QQ, "x")
 f = x^12 + 4*x^10 + 11*x^8 + 4*x^6 - 41*x^4 - 8*x^2 + 37
 K, a = number_field(f)
 @test length(factor(K, f).fac) == 4
end

@testset "automorphisms" begin
  Qx, x = QQ["x"]
  K, a = number_field([x^2 - 2, x^2 - 3], "a", cached = false)
  @test is_normal(K)
  @test length(automorphism_list(K)) == 4
  K, a = number_field([x^2 - 2, x^3 - 2], "a", cached = false)
  @test !is_normal(K)
  @test length(automorphism_list(K)) == 2
end


@testset "NumField/NfAbs/MultDep" begin
  k, a = wildanger_field(5,13; cached = false);
  zk = lll(maximal_order(k))
  class_group(zk)
  h = zk.__attrs[:ClassGrpCtx]
  r = vcat(h.R_gen, h.R_rel);
  r = [x for x = r if isa(x, AbsSimpleNumFieldElem)]
  q = Hecke.syzygies(r)
  @test all(isone, evaluate(FacElem(r, q[i, :])) for i=1:nrows(q))

  U, mU = Hecke.multiplicative_group(r)
  @test preimage(mU, mU(U[2])) == U[2]

  let
    k, a = quadratic_field(2)
    G, f = Hecke.multiplicative_group([a + 1])
    @test length(ngens(G)) == 1
  end

  let
    k, a = cyclotomic_real_subfield(260);
    cyc = k.([[-35, -31, 5185, 6238, -182049, -327894, 2572581, 5635632, -19424768, -49233336, 90943362, 262990470, -288003871, -946540228, 652352355, 2434377764, -1097899475, -4651788369, 1410272928, 6787558934, -1409290293, -7713248636, 1110304665, 6924316532, -695670649, -4959656888, 348267727, 2852308612, -139425447, -1320958484, 44496935, 492435027, -11233498, -147164099, 2212932, 34959781, -332745, -6508380, 36861, 928408, -2834, -97910, 135, 7189, -3, -328, 0, 7], [96, 632, -8880, -35189, 300315, 730520, -4940754, -8356741, 46949309, 61243519, -285377628, -309634589, 1186126682, 1128018718, -3531024655, -3050641033, 7785954804, 6263086853, -13037428130, -9933629555, 16891125658, 12340125248, -17168986737, -12134054222, 13828388360, 9516793156, -8882985920, -5982639129, 4565748636, 3020759290, -1877576700, -1223945471, 615455726, 396223709, -159508622, -101606639, 32235342, 20348096, -4968295, -3111654, 563642, 350610, -44338, -27416, 2159, 1328, -49, -30], [-5, -163, -555, 12357, 38747, -353043, -723728, 5065135, 6175167, -41145279, -30587526, 211276557, 99331135, -740531575, -227094653, 1866791572, 382604025, -3510600283, -489916217, 5056026914, 487065043, -5684514959, -381490786, 5058841170, 237632382, -3598105853, -118320174, 2057751179, 47142136, -948849518, -14984374, 352558537, 3770447, -105112781, -740851, 24930711, 111186, -4637067, -12301, 661247, 945, -69746, -45, 5124, 1, -234, 0, 5], [20, -74, -3417, 10943, 148049, -444651, -2622407, 7580728, 23807026, -67153558, -130600340, 361417207, 478009734, -1300329351, -1242550181, 3324118876, 2391801320, -6291124027, -3510225190, 9072964885, 4010307189, -10179912271, -3619856678, 9019323565, 2608040633, -6375705109, -1509457342, 3619468234, 703854470, -1655245163, -264296295, 609586436, 79585296, -180056392, -19054076, 42297179, 3575532, -7790575, -514139, 1100032, 54656, -114888, -4045, 8358, 186, -378, -4, 8], [2, -19, -832, -663, 36808, 30691, -696786, -334579, 7068809, 1335321, -43209241, 80528, 173413686, -21703793, -485785692, 100929920, 992324171, -263729024, -1525771347, 470579463, 1807341313, -616526248, -1677448237, 615822957, 1234532457, -479511139, -726075585, 295000501, 342647526, -144460309, -129802022, 56451309, 39335331, -17567119, -9459753, 4322821, 1780550, -830130, -256538, 121729, 27304, -13159, -2022, 988, 93, -46, -2, 1], [33, 99, -5243, -16918, 209389, 688611, -3256772, -10781793, 26929308, 89412190, -138388034, -459902619, 483020085, 1604544781, -1210846385, -4017350783, 2263867935, 7498868625, -3242035835, -10720812088, 3625244776, 11969622544, -3209373698, -10583369671, 2271122088, 7482786924, -1292442018, -4256219317, 593072471, 1952905636, -219313312, -722373344, 65078599, 214490777, -15363472, -50683857, 2844416, 9395162, -403769, -1335614, 42397, 140479, -3101, -10294, 141, 469, -3, -10], [-15, 89, 2055, -11982, -59963, 351813, 803483, -4692926, -6194155, 35944262, 31233194, -177560388, -110980846, 607091553, 290724276, -1506251494, -577944547, 2804140551, 889271213, -4013608703, -1074134962, 4496560220, 1029016848, -3994787065, -787535578, 2839986722, 483688386, -1624805334, -238836057, 749911729, 94711171, -278993496, -30028679, 83300509, 7546631, -19787376, -1482037, 3686021, 222381, -526401, -24602, 55600, 1890, -4090, -90, 187, 2, -4], [23, 11, -3426, -5587, 142375, 297720, -2307488, -4992385, 19854143, 42197792, -105853365, -217287798, 381852959, 753150184, -985431826, -1867138611, 1889691645, 3446369776, -2766625359, -4870536432, 3154047851, 5376215022, -2840271032, -4701391188, 2040696181, 3289013272, -1177302360, -1851922604, 547000143, 841514626, -204601612, -308383314, 61359947, 90747493, -14629726, -21258017, 2733895, 3907501, -391506, -550959, 41453, 57489, -3056, -4180, 140, 189, -3, -4], [-47, 132, 7414, -19963, -310002, 842286, 5397422, -14634806, -48427588, 130786346, 263085169, -707633658, -954301567, 2557242990, 2458981215, -6567103683, -4691846623, 12492294265, 6824560305, -18120793377, -7726479752, 20463813824, 6910782535, -18260288859, -4933856842, 13007485557, 2829931165, -7444595300, -1308003431, 3433594631, 486983518, -1275655217, -145449445, 380192982, 34554817, -90128040, -6437373, 16753273, 919425, -2387387, -97134, 251632, 7148, -18473, -327, 843, 7, -18], [12, 71, -1705, -5982, 64401, 153327, -1105310, -1928987, 10466589, 14445389, -61249761, -70901198, 239269223, 242092618, -659375549, -599544336, 1334540239, 1110676882, -2043479260, -1575578176, 2419714929, 1742131849, -2251445966, -1521418816, 1664788501, 1059312841, -985413359, -591577990, 468628894, 265714765, -179076026, -95942275, 54781685, 27732643, -13306532, -6362928, 2530688, 1142377, -368508, -156910, 39646, 15908, -2968, -1121, 138, 49, -3, -1], [-5, -11, 925, 2067, -39227, -87400, 698833, 1550441, -6401867, -14108852, 35431903, 77460660, -130693798, -283240336, 341812129, 734202084, -660702351, -1406733039, 971685766, 2051400268, -1110193577, -2325119818, 1000283961, 2079397409, -718161834, -1482781744, 413584601, 848691585, -191653256, -391138627, 71442722, 145111493, -21338229, -43164715, 5063710, 10208375, -941317, -1892439, 134030, 268878, -14104, -28250, 1033, 2067, -47, -94, 1, 2], [10, 114, -431, -6569, 5911, 133343, -32623, -1382711, 175597, 8897222, -1651991, -39324612, 11486454, 126606523, -49268602, -307965577, 139946176, 579652421, -280745519, -857896003, 415514533, 1009492475, -467190098, -951638690, 406985102, 722259762, -278237221, -442499050, 150404239, 218910335, -64469929, -87251616, 21877070, 27868181, -5838228, -7066777, 1209716, 1401822, -190511, -212616, 22022, 23785, -1761, -1848, 87, 89, -2, -2], [1, -74, -619, 4198, 33815, -76757, -690979, 554100, 7196177, -809425, -44372680, -11742416, 178302402, 87720123, -498374858, -318376917, 1014332862, 749158392, -1553366944, -1256417175, 1833005843, 1575745021, -1695529156, -1521036802, 1244300877, 1150977685, -730143442, -690677865, 343951136, 330775796, -130120641, -126670928, 39393640, 38694160, -9467487, -9359964, 1781252, 1769150, -256577, -255637, 27305, 27260, -2022, -2021, 93, 93, -2, -2], [12, 49, -1142, -1202, 35116, 6305, -507440, -22478, 4199627, 662840, -22278696, -7357495, 81378650, 40208922, -214794375, -135237858, 423796671, 311406903, -640587566, -521183094, 755279502, 658067792, -703781208, -642409507, 523056196, 492825295, -311844109, -300214267, 149526203, 146047974, -57622677, -56822877, 17771204, 17632604, -4348723, -4331222, 832389, 830870, -121850, -121769, 13162, 13160, -988, -988, 46, 46, -1, -1], [29, 340, -1567, -22249, 35962, 528641, -481869, -6347859, 4015696, 45402203, -21895347, -213498779, 82124250, 703416399, -221082669, -1695910070, 441698644, 3086316682, -671941575, -4337184393, 793611342, 4786492514, -738274012, -4199617300, 546535628, 2954654640, -324109219, -1675735945, 154471140, 767810913, -59159005, -283934840, 18135699, 84358044, -4413544, -19959093, 840752, 3706449, -122589, -528079, 13202, 55685, -989, -4092, 46, 187, -1, -4], [19, 130, -1712, -7355, 59011, 142171, -970154, -1317705, 8861461, 6718459, -49877078, -20132603, 186985626, 33795492, -494024145, -15100895, 958175150, -74508442, -1405451661, 226553677, 1593380982, -365714237, -1418473758, 409458854, 1002619918, -343280367, -566702141, 222823472, 257042978, -113830389, -93558620, 46090484, 27222932, -14798041, -6279974, 3746324, 1132458, -738700, -156089, 111068, 15866, -12298, -1120, 945, 49, -45, -1, 1], [14, -92, -1959, 4794, 80909, -66045, -1510381, -3039, 15370733, 6916821, -95347209, -67558438, 389948917, 338098537, -1113074115, -1080038420, 2312635771, 2409131235, -3608624079, -3947457651, 4328529548, 4908601033, -4060155217, -4735480941, 3014673604, 3597952671, -1786114272, -2173958269, 847984125, 1050174413, -322789335, -406107223, 98186399, 125357083, -23678267, -30654943, 4465046, 5858870, -643944, -856124, 68547, 92321, -5073, -6921, 233, 322, -5, -7], [7, 20, -912, -280, 36168, -15071, -641937, 415013, 6173490, -4446387, -36057557, 26564851, 139104780, -101970163, -376295322, 272401558, 744862396, -532820951, -1112696526, 789705113, 1282913804, -908215352, -1160424498, 824055179, 832924652, -596561031, -477938476, 346989756, 220058118, -162687505, -81315356, 61464876, 24026354, -18635791, -5630402, 4495685, 1031929, -850629, -144649, 123409, 14964, -13244, -1076, 990, 48, -46, -1, 1], [-3, -1, 526, -221, -24331, 20039, 498558, -482752, -5490947, 5639927, 36752407, -38693134, -162374205, 172887233, 501255102, -536930205, -1125864200, 1211152891, 1895159501, -2047028054, -2443883792, 2651643350, 2453972359, -2676395722, -1941455443, 2129892687, 1219795800, -1346938538, -611272978, 679782806, 244522697, -273988668, -77843432, 87918397, 19573059, -22289079, -3835245, 4404563, 572985, -663748, -63012, 73635, 4806, -5666, -227, 270, 5, -6], [-15, 76, 2199, -11771, -58681, 340562, 693485, -4407226, -4537346, 32454037, 18181714, -153882341, -46464425, 506272732, 73619041, -1213941525, -55000374, 2194917587, -44403167, -3066368962, 193239378, 3368812440, -303380533, -2947580091, 311825552, 2071803213, -234575863, -1175966152, 134614521, 540120162, -59999508, -200503603, 20898742, 59873248, -5676209, -14252808, 1190103, 2665265, -188875, -382647, 21938, 40680, -1759, -3015, 87, 139, -2, -3], [22, 109, -3136, -12890, 123140, 488451, -1861861, -7434277, 14866750, 60457706, -73515533, -305989310, 246576461, 1052828114, -594242282, -2604535386, 1069904229, 4811555631, -1479075557, -6817590658, 1601002148, 7552919729, -1375847394, -6633146449, 947593179, 4662025227, -526055129, -2637803641, 235949306, 1204613564, -85418733, -443687033, 24844137, 131232447, -5753498, -30900439, 1045438, 5709368, -145667, -809219, 15011, 84879, -1077, -6204, 48, 282, -1, -6], [38, 202, -3988, -8887, 141791, 91801, -2276983, 306734, 19668386, -10478171, -104673749, 79681100, 374519159, -339470756, -954127822, 960097608, 1800474391, -1943405708, -2588401809, 2939921807, 2893307592, -3417790162, -2551926888, 3111543924, 1794366812, -2246703995, -1012390324, 1297011203, 459737779, -601087739, -167975855, 223705503, 49180945, -66621194, -11441476, 15747979, 2085061, -2913744, -291017, 412667, 30014, -43171, -2154, 3142, 96, -142, -2, 3], [13, 61, -1419, -4591, 42634, 97264, -555582, -1037754, 3948965, 6765351, -17300230, -29687224, 50051839, 92818367, -99090349, -214465013, 134683758, 375537943, -118588881, -507484191, 47516941, 536410048, 35006368, -447822585, -80525200, 297217024, 78229819, -157352581, -51070015, 66462608, 24602872, -22319413, -9027081, 5912670, 2545117, -1218892, -548932, 191292, 89086, -22063, -10538, 1762, 858, -87, -43, 2, 1, 0], [-15, 83, 722, -5068, -11711, 109557, 66383, -1226314, 107673, 8287958, -3326243, -36976101, 20199727, 115547658, -70564916, -263631907, 167399580, 452520148, -289118116, -597319022, 377878869, 616121008, -382897191, -502303100, 305539779, 326104299, -193899651, -169255602, 98374816, 70259143, -39946970, -23246872, 12944294, 6082838, -3321492, -1241572, 665777, 193364, -101973, -22179, 11519, 1765, -904, -87, 44, 2, -1, 0], [3, 0, -172, -336, 7071, 13972, -129661, -252420, 1221384, 2320009, -6875396, -12652167, 25533535, 45290299, -66661620, -113566476, 127638501, 208372146, -184549320, -288364995, 205668735, 307521795, -179202223, -256551386, 123233914, 169118665, -67240876, -88597001, 29152715, 36949305, -10017214, -12237838, 2708321, 3196018, -568617, -649537, 90724, 100528, -10622, -11440, 860, 902, -43, -44, 1, 1, 0, 0], [-7, 93, 21, -1607, -6501, 6660, 262364, -112466, -3693645, 2627745, 27078723, -24732849, -122066306, 127214279, 370664379, -417794380, -803189618, 952790473, 1291582250, -1588237043, -1584447231, 2001638093, 1512197375, -1951695523, -1138322874, 1495595388, 681935669, -909955217, -326706459, 442064401, 125297661, -171738763, -38351680, 53211140, 9297177, -13051419, -1760902, 2500309, 254901, -366008, -27220, 39519, 2020, -2965, -93, 138, 2, -3], [-9, 6, 1495, -1374, -68741, 74539, 1372556, -1632421, -14584538, 18223216, 93104506, -119137117, -388789480, 502327677, 1128316387, -1460537659, -2377875325, 3070369256, 3758375051, -4828942343, -4562501130, 5825030701, 4328711018, -5487320469, -3249570078, 4088476536, 1945894320, -2429514678, -933470878, 1156547781, 358947424, -441365449, -110273509, 134590683, 26853489, -32539577, -5112622, 6152134, 744359, -889706, -79984, 94987, 5975, -7052, -277, 325, 6, -7], [37, 145, -4349, -7919, 172270, 170713, -3158585, -2300214, 32502535, 20974307, -209778741, -129740886, 912789977, 555873321, -2815200316, -1702374924, 6381375106, 3840819028, -10920634500, -6545904640, 14395887437, 8594835692, -14837807338, -8824666610, 12086453015, 7161973878, -7836053587, -4627371601, 4058456157, 2388972203, -1679582856, -985776853, 553492083, 323986347, -144096014, -84141531, 29232309, 17031848, -4520268, -2628400, 514270, 298488, -40554, -23499, 1979, 1145, -45, -26], [7, -36, -897, 128, 37372, 67902, -695983, -1795143, 7061902, 20315040, -43930681, -130341425, 180637319, 537236146, -518190770, -1531059794, 1080106682, 3166798643, -1687092366, -4917678593, 2021246431, 5874422827, -1889786714, -5493241337, 1396020461, 4070764699, -821500086, -2409729226, 386779088, 1144226866, -145798801, -436030158, 43860149, 132891467, -10447437, -32136016, 1943608, 6081205, -276219, -880725, 28942, 94211, -2106, -7011, 95, 324, -2, -7], [53, 175, -8289, -28917, 315951, 1104577, -4786126, -16712256, 38855430, 135458695, -196834997, -685127156, 678939370, 2359871883, -1685077434, -5850178107, 3124010305, 10835929255, -4442115221, -15397849105, 4937782168, 17109019215, -4349982451, -15069620683, 3066000978, 10621827622, -1739183394, -6026528788, 796036569, 2759469061, -293781916, -1018961723, 87043686, 302116729, -20525638, -71301514, 3797057, 13202916, -538698, -1875174, 56545, 197067, -4135, -14430, 188, 657, -4, -14], [-6, 0, 878, 552, -31855, -3838, 543861, -205635, -5206308, 3786896, 30974560, -29395254, -123312312, 133811996, 346584647, -404321319, -715333854, 867646834, 1116341561, -1380165873, -1346215171, 1675283109, 1274663816, -1583345967, -958411871, 1181491001, 576460992, -702370286, -278396112, 334263917, 107969283, -127471783, -33503514, 38832828, 8250663, -9377467, -1590076, 1770669, 234517, -255718, -25543, 27262, 1935, -2021, -91, 93, 2, -2], [0, 0, 0, -660, 4752, 27181, -154044, -473066, 1901526, 4142710, -12846768, -21515637, 55102047, 73487364, -162652295, -176277402, 347582408, 310271881, -556557216, -413053275, 684229554, 424835369, -657215869, -342608345, 499268290, 218753990, -302366036, -111187479, 146594535, 45053790, -56926540, -14515655, 17646816, 3691379, -4332552, -731157, 830946, 110371, -121771, -12259, 13160, 944, -988, -45, 46, 1, -1, 0], [-16, -131, 2536, 21470, -81313, -869527, 687342, 14144546, 255099, -123892734, -33923757, 675550836, 230844647, -2492372518, -844164883, 6564676474, 2032373569, -12813123172, -3495488260, 19041137988, 4492148182, -21978869579, -4436341473, 19996644318, 3428932717, -14489322816, -2098536492, 8417274559, 1023615406, -3933101901, -398770522, 1477959199, 123786573, -444898356, -30399831, 106393318, 5828491, -19929464, -853624, 2859347, 92194, -303192, -6918, 22377, 322, -1026, -7, 22], [65, 228, -10123, -36255, 386701, 1389278, -5843924, -21125929, 47348686, 172421962, -239478873, -878703554, 824881648, 3049146621, -2044800801, -7610952037, 3787181120, 14184374323, -5381491521, -20265688890, 5980240356, 22624745086, -5269023235, -20009986041, 3715870848, 14154358093, -2109938100, -8055569967, 967117197, 3698389124, -357578057, -1368824500, 106182047, 406662119, -25103611, -96141574, 4657567, 17829363, -662927, -2535561, 69831, 266770, -5126, -19553, 234, 891, -5, -19], [10, 175, 25, -12141, -19819, 325596, 513429, -4565695, -5862335, 38416655, 37768336, -210270604, -154225033, 792014081, 428617390, -2141771248, -850571986, 4296393013, 1246344428, -6557411130, -1380463170, 7764355195, 1174037758, -7237043750, -773670657, 5365935349, 396092245, -3186505855, -156776751, 1520676715, 47217987, -583156388, -10428255, 179021620, 1536318, -43632619, -100452, 8325225, -13379, -1216009, 4441, 131200, -555, -9848, 36, 459, -1, -10], [11, 91, -699, -4956, 18823, 96229, -269558, -931601, 2252920, 5192967, -11901550, -18473533, 42406963, 44993972, -107021561, -78715863, 198363651, 102262045, -277420975, -100967032, 298678432, 76972722, -251170905, -45766022, 166631246, 21328721, -87722246, -7792095, 36716928, 2220128, -12191990, -487664, 3189507, 80919, -648908, -9804, 100491, 818, -11439, -42, 902, 1, -44, 0, 1, 0, 0, 0], [-3, 24, 445, -2138, -13627, 43913, 203387, -431629, -1749298, 2497088, 9518652, -9393133, -34946885, 24403838, 90737941, -45628902, -172605404, 63236958, 247068876, -66365235, -271523395, 53544920, 232493430, -33542535, -156686595, 16398252, 83616483, -6258809, -35407550, 1856031, 11872783, -422873, -3131162, 72557, 641173, -9065, -99789, 778, 11400, -41, -901, 1, 44, 0, -1, 0, 0, 0], [6, -68, -389, 4775, 11868, -120801, -179347, 1551559, 1482857, -11682858, -7528477, 56905251, 25467365, -191754062, -60674744, 468415582, 105797208, -857774021, -138735435, 1206831876, 139476735, -1328468131, -108930186, 1159489044, 66633450, -809939898, -32043636, 455482034, 12104542, -206766840, -3570982, 75721314, 812890, -22276664, -139860, 5219812, 17575, -960337, -1521, 135630, 81, -14187, -2, 1035, 0, -47, 0, 1], [4, 8, -620, -1452, 24191, 60534, -393057, -986191, 3485354, 8606843, -19351824, -46852694, 73020313, 173331300, -197511748, -459943772, 397264483, 908066374, -609809635, -1369110891, 727956951, 1606673537, -685056930, -1487999120, 513102473, 1098245422, -307737186, -650009860, 148216737, 309413265, -57303467, -118410326, 17712859, 36284457, -4340988, -8828347, 831687, 1681578, -121811, -245180, 13161, 26404, -988, -1978, 46, 92, -1, -2], [-2, -20, 536, 2937, -27717, -119165, 625716, 2131296, -7515717, -20614438, 53464605, 123134050, -245416000, -493584217, 774122002, 1402207287, -1755930123, -2931895757, 2960878949, 4637007747, -3803995495, -5660642309, 3792126694, 5414308664, -2972172036, -4101618110, 1847936327, 2478591916, -916055938, -1199268628, 362531886, 464753742, -114233516, -143756675, 28449862, 35212287, -5526305, -6736794, 819247, 984709, -89486, -106138, 6786, 7947, -319, -369, 7, 8], [18, 34, -2698, -6466, 111214, 290970, -1780651, -4681191, 15134734, 39015625, -79774620, -200044937, 284811445, 693506691, -728215436, -1723521692, 1384907890, 3193100157, -2012481843, -4532468446, 2278667388, 5026939920, -2038970031, -4417821822, 1456167455, 3106315940, -835203250, -1758012571, 385840010, 802952516, -143500240, -295769571, 42788911, 87485499, -10142402, -20600046, 1884005, 3806232, -268137, -539479, 28210, 56586, -2066, -4136, 94, 188, -2, -4], [7, 66, -458, -4481, 13502, 118188, -195903, -1590920, 1528031, 12362405, -7395697, -61490842, 24716367, 210801869, -61429212, -524350448, 119107015, 981106096, -184910753, -1416688645, 232221476, 1607724660, -236297402, -1452397423, 194493901, 1053460877, -129174408, -616595620, 69028874, 291762419, -29565135, -111458827, 10088681, 34208909, -2717317, -8358779, 569393, 1602214, -90765, -235458, 10623, 25588, -860, -1936, 43, 91, -1, -2], [8, 34, -833, -1997, 27712, 34457, -419500, -278730, 3579600, 1140436, -19199763, -1845891, 69395971, -3686638, -177580299, 27850368, 333634759, -77148038, -472857901, 135345376, 515827146, -169195156, -439461988, 158448676, 295329323, -114139065, -157471395, 64179119, 66748081, -28368378, -22442017, 9867144, 5943707, -2687563, -1224037, 566657, 191844, -90611, -22098, 10619, 1763, -860, -87, 43, 2, -1, 0, 0], [-4, -22, 562, 1994, -18772, -46565, 272730, 549649, -2005842, -4387425, 8274770, 25007283, -19356036, -101738807, 19955446, 298505214, 21849875, -644723738, -120302160, 1047979840, 235328225, -1307303576, -296444726, 1271404815, 270272332, -975479575, -186806900, 595253252, 100123742, -290200678, -42064112, 113136419, 13892394, -35165209, -3593140, 8648451, 719839, -1660416, -109472, 243462, 12215, -26318, -943, 1976, 45, -92, -1, 2], [210, 2084, -13637, -126833, 340067, 2895221, -4464328, -34348263, 35739688, 245950756, -190619142, -1164654303, 717229263, 3875689343, -1979458462, -9456683714, 4119807104, 17445281999, -6599603620, -24886720798, 8262429728, 27916047802, -8176735128, -24923366065, 6448302520, 17859537782, -4073129618, -10324288728, 2065355687, 4824393612, -840016119, -1820141335, 272863365, 551825129, -70187612, -133237990, 14095088, 25247709, -2160865, -3669883, 244035, 394684, -19122, -29569, 928, 1377, -21, -30], [18, -24, -2784, 4230, 115583, -184104, -2032322, 3348290, 18857052, -31415996, -106866298, 178024191, 404726359, -670783486, -1085951533, 1786956646, 2149114352, -3508661732, -3228658966, 5229423169, 3760328653, -6043699131, -3447494746, 5500151249, 2514888560, -3984290144, -1469826430, 2313285668, 690587003, -1080134456, -260820637, 405560132, 78881221, -121980420, -18946036, 29146009, 3563396, -5455095, -513198, 782036, 54611, -82860, -4044, 6111, 186, -280, -4, 6], [-2713, 4945, 447188, -815664, -20040624, 36587106, 384306632, -703672673, -3858960576, 7102112565, 23031982182, -42700252012, -89758632197, 167965806150, 243854028662, -461438666005, -483408266224, 926581281665, 722276079416, -1404644210259, -832568314129, 1645322420911, 752881478541, -1514145774593, -540365015347, 1107511464292, 310138037086, -648656088353, -142880415726, 305336159971, 52847012816, -115528582832, -15635573424, 35005341142, 3670402304, -8424522348, -674138444, 1587903366, 94738313, -229218643, -9830314, 24452418, 709343, -1815506, -31772, 83735, 665, -1806], [-10905783, 12283682, 1881373430, -2880879402, -85534349781, 140411320729, 1652316742208, -2784069405851, -16685266942760, 28456220632093, 100157782779699, -171923016270777, -392841359087618, 676982142150521, 1075097994695838, -1857704184120514, -2149012414442044, 3720857427242667, 3241037512918911, -5620749764237423, -3774990373338766, 6555838699453068, 3453036391676562, -6004111220611771, -2509597445043704, 4368588854198322, 1460074741831577, -2544303410455187, -682576779836253, 1190630336702012, 256451943420919, -447757338943074, -77151569226899, 134826526369716, 18433926996838, -32242350127814, -3449390818191, 6038304117102, 494323301126, -866031415977, -52352144530, 91789657587, 3859052246, -6771170203, -176720835, 310300176, 3784697, -6650040]]);
    C, mC = Hecke.multiplicative_group(cyc; task = :modulo_tor);
    @test rank(C) == 47
  end
end

@testset "is_lin_disjoint" begin
  R,x=polynomial_ring(QQ, "x")
  K,a=number_field(x^2+1)
  L,b=number_field(x^2+x+1//2)
  @test !is_linearly_disjoint(L,K)
end
